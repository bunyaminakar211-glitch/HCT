<!DOCTYPE html>
<html lang="tr" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BHT • Bilgi Havuzu Türkiye</title>
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --bg: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f766e 100%);
      --card: rgba(30, 41, 59, 0.7);
      --text: #e2e8f0;
      --accent: #0ea5e9;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .screen { 
      position: fixed; inset: 0; 
      display: none; align-items: center; justify-content: center; 
      padding: 20px; 
    }
    .screen.active { display: flex; }
    .auth-box {
      background: var(--card);
      backdrop-filter: blur(12px);
      border-radius: 16px;
      padding: 32px 28px;
      width: 100%; max-width: 420px;
      text-align: center;
      border: 1px solid rgba(255,255,255,0.08);
    }
    h1 { font-size: 2.8rem; margin-bottom: 8px; letter-spacing: -1px; }
    .divider { margin: 24px 0; color: #64748b; font-size: 0.9rem; }
    .btn {
      width: 100%; padding: 14px; margin: 10px 0;
      border: none; border-radius: 10px; font-size: 1.05rem; cursor: pointer;
    }
    .btn.google { background: #4285f4; color: white; }
    .btn.primary { background: var(--accent); color: white; }
    input {
      width: 100%; padding: 14px; margin: 10px 0;
      background: rgba(255,255,255,0.06); border: 1px solid #334155;
      border-radius: 10px; color: white; font-size: 1rem;
    }
    input::placeholder { color: #94a3b8; }

    /* Sidebar */
    .sidebar {
      position: fixed; left: -300px; top: 0; width: 300px; height: 100%;
      background: rgba(15,23,42,0.96); backdrop-filter: blur(16px);
      transition: left 0.35s cubic-bezier(0.23,1,0.32,1);
      z-index: 2000; border-right: 1px solid rgba(255,255,255,0.06);
    }
    .sidebar.open { left: 0; }
    .sidebar-content { padding: 80px 20px 20px; }
    .sidebar ul { list-style: none; }
    .sidebar li {
      padding: 16px 20px; margin: 8px 0;
      border-radius: 12px; cursor: pointer; transition: all 0.2s;
    }
    .sidebar li:hover { background: rgba(255,255,255,0.08); }

    .menu-btn {
      position: fixed; top: 16px; left: 16px; z-index: 3000;
      background: rgba(30,41,59,0.7); color: white;
      border: none; width: 48px; height: 48px; border-radius: 12px;
      font-size: 1.6rem; cursor: pointer;
    }

    #content-area {
      padding: 80px 20px 40px;
      max-width: 900px; margin: 0 auto;
    }
    .tool-section { display: none; background: var(--card); padding: 24px; border-radius: 16px; margin: 20px 0; backdrop-filter: blur(8px); }
    .tool-section.active { display: block; }

    .cf-turnstile { margin: 20px auto; }
  </style>
</head>
<body>

<!-- AUTH SCREENS -->
<div id="auth-screen" class="screen active">
  <div class="auth-box">
    <h1>BHT</h1>
    <p>Bilgi Havuzu Türkiye</p>

    <div id="g_id_onload"
         data-client_id="BURAYA_CLIENT_ID_YAZ.apps.googleusercontent.com"
         data-callback="handleGoogleResponse"
         data-auto_prompt="false">
    </div>
    <div class="g_id_signin"
         data-type="standard"
         data-size="large"
         data-theme="filled_blue"
         data-text="signin_with"
         data-shape="pill"
         data-logo_alignment="left">
    </div>

    <div class="divider">veya</div>

    <form id="login-form">
      <input type="email"    id="login-email"    placeholder="E-posta" required>
      <input type="password" id="login-password" placeholder="Şifre"   required>
      <button type="submit" class="btn primary">Giriş Yap</button>
    </form>

    <p style="margin-top:20px;">Hesabın yok mu? <a href="#" id="show-register" style="color:var(--accent);">Kayıt Ol</a></p>
  </div>
</div>

<div id="register-screen" class="screen">
  <div class="auth-box">
    <h1>Kayıt Ol</h1>
    <form id="register-form">
      <input type="email"    id="reg-email"    placeholder="E-posta" required>
      <input type="password" id="reg-password" placeholder="Şifre"   required>
      <button type="submit" class="btn primary">Hesap Oluştur</button>
    </form>
    <p style="margin-top:20px;"><a href="#" id="show-login" style="color:var(--accent);">← Giriş ekranına dön</a></p>
  </div>
</div>

<!-- MAIN SCREEN -->
<div id="main-screen" class="screen">
  <button class="menu-btn" id="menu-toggle">☰</button>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-content">
      <ul>
        <li data-tool="imei">IMEI Sorgula</li>
        <li data-tool="ipgeo">IP → Konum Bul</li>
        <li data-tool="weather">Hava Durumu</li>
        <li data-tool="stocks">Canlı BIST Hisseleri</li>
      </ul>
    </div>
  </div>

  <div id="content-area">
    <h2 style="text-align:center; margin:40px 0 60px; opacity:0.9;">Hoş geldin</h2>

    <div id="tool-imei" class="tool-section">
      <h3>IMEI Sorgulama</h3>
      <input type="text" id="imei-input" placeholder="15 haneli IMEI numarası" maxlength="15">
      <button onclick="queryIMEI()" class="btn primary" style="margin-top:16px;">Sorgula</button>
      <pre id="imei-result" style="margin-top:20px; white-space:pre-wrap; background:rgba(0,0,0,0.3); padding:16px; border-radius:12px;"></pre>
    </div>

    <div id="tool-ipgeo" class="tool-section">
      <h3>IP Konum Sorgulama</h3>
      <input type="text" id="ip-input" placeholder="Ör: 192.168.1.1 veya boş bırak (kendi IP)">
      <button onclick="queryIPGeo()" class="btn primary" style="margin-top:16px;">Konum Bul</button>
      <pre id="ipgeo-result" style="margin-top:20px; white-space:pre-wrap; background:rgba(0,0,0,0.3); padding:16px; border-radius:12px;"></pre>
    </div>

    <div id="tool-weather" class="tool-section">
      <h3>Hava Durumu</h3>
      <input type="text" id="weather-city" placeholder="Şehir / İlçe (ör: Diyarbakır, Bağlar)">
      <button onclick="getWeather()" class="btn primary" style="margin-top:16px;">Göster</button>
      <div id="weather-result" style="margin-top:20px;"></div>
    </div>

    <div id="tool-stocks" class="tool-section">
      <h3>Canlı BIST</h3>
      <div id="stocks-result" style="margin-top:16px; font-family:monospace;"></div>
    </div>
  </div>
</div>

<script>
// =============================================
//  EKRAN GEÇİŞLERİ
// =============================================
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

document.getElementById('show-register').onclick = e => { e.preventDefault(); showScreen('register-screen'); };
document.getElementById('show-login').onclick    = e => { e.preventDefault(); showScreen('auth-screen'); };

// =============================================
//  SIDEBAR (Çekmece)
// =============================================
const sidebar = document.getElementById('sidebar');
const toggle  = document.getElementById('menu-toggle');

toggle.onclick = () => sidebar.classList.toggle('open');

document.addEventListener('click', e => {
  if (sidebar.classList.contains('open') && 
      !sidebar.contains(e.target) && 
      !toggle.contains(e.target)) {
    sidebar.classList.remove('open');
  }
});

// Araç seçimi
document.querySelectorAll('[data-tool]').forEach(li => {
  li.onclick = () => {
    document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
    document.getElementById('tool-'+li.dataset.tool).classList.add('active');
    sidebar.classList.remove('open');
  };
});

// =============================================
//  GOOGLE GIRIS
// =============================================
function handleGoogleResponse(response) {
  fetch('https://your-backend-domain.com/google-callback.php', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ credential: response.credential })
  })
  .then(r => r.json())
  .then(data => {
    if (data.success) {
      localStorage.setItem('bht_token', data.token || 'simulated');
      showScreen('main-screen');
      loadStocks(); // otomatik yükle örnek
    } else {
      alert('Google giriş hatası');
    }
  })
  .catch(() => alert('Bağlantı sorunu'));
}

// =============================================
//  SADECE SIMÜLASYON / GERÇEK API ÖRNEKLERİ
// =============================================
function queryIMEI() {
  const imei = document.getElementById('imei-input').value.trim();
  if (imei.length !== 15) return alert('15 haneli IMEI girin');
  document.getElementById('imei-result').textContent = 'Sorgulanıyor...';
  // Gerçekte: fetch('https://api.imei.info/v1/check/'+imei, {headers:{Authorization:'Bearer ...'}})
  setTimeout(() => {
    document.getElementById('imei-result').textContent = 
`Cihaz:     Samsung Galaxy A54
Marka:     Samsung
Model:     SM-A546E
Ülke:      Türkiye
Durum:     Kayıtlı / Aktif
Kayıt Tarihi: 12.03.2024
Son Sorgu:    ${new Date().toLocaleString('tr-TR')}`;
  }, 1400);
}

function queryIPGeo() {
  const ip = document.getElementById('ip-input').value.trim() || '';
  document.getElementById('ipgeo-result').textContent = 'Sorgulanıyor...';
  fetch(`https://ipapi.co/${ip || 'json'}/json/`)
    .then(r => r.json())
    .then(d => {
      document.getElementById('ipgeo-result').textContent = 
`IP:          ${d.ip || 'Kendi IP'}
Şehir:       ${d.city || '—'}
Bölge:       ${d.region || '—'}
Ülke:        ${d.country_name || '—'}
Konum:       ${d.latitude}, ${d.longitude}
Organizasyon:${d.org || '—'}
Saat dilimi: ${d.timezone || '—'}`;
    })
    .catch(() => document.getElementById('ipgeo-result').textContent = 'Hata oluştu');
}

function getWeather() {
  const city = document.getElementById('weather-city').value.trim() || 'Diyarbakır';
  document.getElementById('weather-result').innerHTML = 'Yükleniyor...';
  fetch(`https://wttr.in/${encodeURIComponent(city)}?format=j1`)
    .then(r => r.json())
    .then(d => {
      const c = d.current_condition[0];
      document.getElementById('weather-result').innerHTML = `
        <b>${d.nearest_area[0].areaName[0].value}</b><br>
        Sıcaklık: ${c.temp_C} °C<br>
        Hissedilen: ${c.FeelsLikeC} °C<br>
        Durum: ${c.weatherDesc[0].value}<br>
        Nem: ${c.humidity}%<br>
        Rüzgar: ${c.windspeedKmph} km/s ${c.winddir16Point}`;
    });
}

function loadStocks() {
  document.getElementById('stocks-result').innerHTML = 'Yükleniyor...';
  // Gerçek borsa verisi için: https://finans.mynet.com/borsa/ veya websocket
  // Burada basit simülasyon
  setTimeout(() => {
    document.getElementById('stocks-result').innerHTML = `
XU100      9.842,15   +1,24%<br>
THYAO      312,50     +2,8%<br>
GARAN      118,70     -0,9%<br>
EREGL      54,20      +3,1%<br>
SISE       48,95      +1,6%<br>
(as of ${new Date().toLocaleTimeString('tr-TR')})`;
  }, 1200);
}

// Login & Register simülasyon (gerçekte backend gerekir)
document.getElementById('login-form').onsubmit = e => {
  e.preventDefault();
  showScreen('main-screen');
};
document.getElementById('register-form').onsubmit = e => {
  e.preventDefault();
  showScreen('main-screen');
};
</script>
</body>
</html>
